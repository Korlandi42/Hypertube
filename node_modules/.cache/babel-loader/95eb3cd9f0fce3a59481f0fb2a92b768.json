{"ast":null,"code":"import store from '../store';\nimport req from '../../utils/req';\n\nfunction translateGenre(genre) {\n  switch (genre) {\n    case 'science-fiction':\n      return 'sci-fi';\n\n    case 'sports':\n      return 'sport';\n\n    default:\n      return genre;\n  }\n}\n\nexport function exists(code, list) {\n  var set = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var movies = store.getState().search.movies;\n\n  if (!set) {\n    for (var i in movies) {\n      if (movies[i]) {\n        if (movies[i].code === code) return true;\n      }\n    }\n  }\n\n  return false;\n}\nexport function formatMovies(list, callback) {\n  var set = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n  var movies = [];\n  var title = '';\n  var image = '';\n  var id = '';\n  var code = '';\n\n  for (var i in list) {\n    if (list[i].images && list[i].images.banner) {\n      image = list[i].images.poster;\n      title = list[i].title;\n      id = list[i].imdb_id;\n      code = list[i].imdb_id;\n    } else if (list[i].medium_cover_image) {\n      image = list[i].medium_cover_image;\n      title = list[i].title;\n      code = list[i].imdb_code;\n      id = list[i].id;\n    } else {\n      id = '';\n    }\n\n    if (id && !exists(code, movies, set)) {\n      movies.push({\n        id: id,\n        code: code,\n        image: image,\n        title: title\n      });\n    }\n  }\n\n  callback(movies);\n}\nexport function fetchMovies() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return function (dispatch, getState) {\n    var word = options.word,\n        genre = options.genre,\n        sort = options.sort,\n        api = options.api;\n    var search = getState().search;\n    if (word === undefined) word = search.word;\n    if (genre === undefined) genre = search.genre;\n    if (sort === undefined) sort = search.sort;\n    if (api === undefined) api = search.api;\n    var list = [];\n\n    if (api === 'popcorntime' || api === 'yts') {\n      dispatch(setOptions(word, genre, sort, api));\n    }\n\n    if (api === 'popcorntime') {\n      var url = 'https://tv-v2.api-fetch.website/movies/1?';\n      if (word) url += '&keywords=' + word;\n      if (genre) url += '&genre=' + genre;\n      if (sort) url += '&sort=' + sort;\n      dispatch(fetching());\n      req(url).then(function (res) {\n        formatMovies(res, function (movies) {\n          dispatch(setMovies(movies));\n        }, true);\n      });\n    } else if (api === 'yts') {\n      var _url = 'https://yts.am/api/v2/list_movies.json?sort_by=like_count&limit=30';\n      if (word) _url += '&query_term=' + word;\n      if (genre) _url += '&genre=' + translateGenre(genre);\n      if (sort) _url += '&sort_by=' + sort;\n      dispatch(fetching());\n      req(_url).then(function (res) {\n        if (res.data.movies) list = res.data.movies;\n        formatMovies(list, function (movies) {\n          dispatch(setMovies(movies));\n        }, true);\n      });\n    }\n  };\n}\nexport function fetchAddMovies() {\n  return function (dispatch, getState) {\n    var list = [];\n    var search = getState().search;\n    if (search.isFetching) return;\n\n    if (search.api === 'popcorntime') {\n      var url = 'https://tv-v2.api-fetch.website/movies/' + search.page + 1 + '?';\n      if (search.word) url += '&keywords=' + search.word;\n      if (search.genre) url += '&genre=' + search.genre;\n      if (search.sort) url += '&sort=' + search.sort;\n      dispatch(fetching());\n      req(url).then(function (res) {\n        formatMovies(res, function (movies) {\n          dispatch(addMovies(movies));\n        });\n      });\n    } else if (search.api === 'yts') {\n      var _url2 = 'https://yts.am/api/v2/list_movies.json?sort_by=like_count&limit=50&page=' + search.page;\n\n      if (search.word) _url2 += '&query_term=' + search.word;\n      if (search.genre) _url2 += '&genre=' + translateGenre(search.genre);\n      if (search.sort) _url2 += '&sort_by=' + search.sort;\n      dispatch(fetching());\n      req(_url2).then(function (res) {\n        if (res.data.movies) list = res.data.movies;\n        formatMovies(list, function (movies) {\n          dispatch(addMovies(movies));\n        });\n      });\n    }\n  };\n}\nexport function addMovies(res) {\n  return {\n    type: 'ADD_MOVIES',\n    movies: res\n  };\n}\nexport function setMovies(movies) {\n  return {\n    type: 'SET_MOVIES',\n    movies: movies\n  };\n}\nexport function setOptions(word, genre, sort, api) {\n  return {\n    type: 'SET_OPTIONS',\n    word: word,\n    genre: genre,\n    sort: sort,\n    api: api\n  };\n}\nexport function fetching() {\n  return {\n    type: 'SEARCH_FETCHING'\n  };\n}","map":{"version":3,"sources":["/Users/korlandi/42/hypertube/src/redux/search/actions.js"],"names":["store","req","translateGenre","genre","exists","code","list","set","movies","getState","search","i","formatMovies","callback","title","image","id","images","banner","poster","imdb_id","medium_cover_image","imdb_code","push","fetchMovies","options","dispatch","word","sort","api","undefined","setOptions","url","fetching","then","res","setMovies","data","fetchAddMovies","isFetching","page","addMovies","type"],"mappings":"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","sourcesContent":["import store from '../store'\nimport req from '../../utils/req'\n\nfunction translateGenre(genre) {\n  switch(genre) {\n    case 'science-fiction':\n      return 'sci-fi'\n    case 'sports':\n      return 'sport'\n    default:\n      return genre\n  }\n}\n\nexport function exists(code, list, set = false) {\n  const { movies } = store.getState().search\n  if (!set) {\n    for (let i in movies) {\n      if (movies[i]) {\n        if (movies[i].code === code)\n          return true\n      }\n    }\n  }\n  return false\n}\n\nexport function formatMovies(list, callback, set = false) {\n  let movies = []\n  let title = ''\n  let image = ''\n  let id = ''\n  let code = ''\n\n  for(let i in list) {\n    if (list[i].images && list[i].images.banner) {\n      image = list[i].images.poster\n      title = list[i].title\n      id = list[i].imdb_id\n      code = list[i].imdb_id\n    } else if (list[i].medium_cover_image) {\n      image = list[i].medium_cover_image\n      title = list[i].title\n      code = list[i].imdb_code\n      id = list[i].id\n    } else {\n      id = ''\n    }\n    if (id && !exists(code, movies, set)) {\n      movies.push({\n        id: id,\n        code: code,\n        image: image,\n        title: title\n      })\n    }\n  }\n  callback(movies)\n}\n\nexport function fetchMovies(options = {}) {\n  return (dispatch, getState) => {\n\n    let { word, genre, sort, api } = options\n    let search = getState().search\n    if (word === undefined) word = search.word\n    if (genre === undefined) genre = search.genre\n    if (sort === undefined) sort = search.sort\n    if (api === undefined) api = search.api\n    let list = []\n\n    if (api === 'popcorntime' || api === 'yts') {\n      dispatch(setOptions(word, genre, sort, api))\n    }\n    if (api === 'popcorntime') {\n      let url = 'https://tv-v2.api-fetch.website/movies/1?'\n      if (word) url += '&keywords=' + word\n      if (genre) url += '&genre=' + genre\n      if (sort) url += '&sort=' + sort\n      dispatch(fetching())\n      req(url).then(res => {\n        formatMovies(res, (movies) => {\n          dispatch(setMovies(movies))\n        }, true)\n      })\n    } else if (api === 'yts') {\n      let url = 'https://yts.am/api/v2/list_movies.json?sort_by=like_count&limit=30'\n      if (word) url += '&query_term=' + word\n      if (genre) url += '&genre=' + translateGenre(genre)\n      if (sort) url += '&sort_by=' + sort\n      dispatch(fetching())\n      req(url).then(res => {\n        if (res.data.movies)\n          list = res.data.movies\n        formatMovies(list, (movies) => {\n          dispatch(setMovies(movies))\n        }, true)\n      })\n    }\n  }\n}\n\nexport function fetchAddMovies() {\n  return (dispatch, getState) => {\n    let list = []\n    let search = getState().search\n    if (search.isFetching) return\n\n    if (search.api === 'popcorntime') {\n      let url = 'https://tv-v2.api-fetch.website/movies/' + search.page + 1 + '?'\n      if (search.word) url += '&keywords=' + search.word\n      if (search.genre) url += '&genre=' + search.genre\n      if (search.sort) url += '&sort=' + search.sort\n      dispatch(fetching())\n      req(url).then(res => {\n        formatMovies(res, (movies) => {\n          dispatch(addMovies(movies))\n        })\n      })\n    } else if (search.api === 'yts') {\n      let url = 'https://yts.am/api/v2/list_movies.json?sort_by=like_count&limit=50&page=' + search.page\n      if (search.word) url += '&query_term=' + search.word\n      if (search.genre) url += '&genre=' + translateGenre(search.genre)\n      if (search.sort) url += '&sort_by=' + search.sort\n      dispatch(fetching())\n      req(url).then(res => {\n        if (res.data.movies)\n          list = res.data.movies\n        formatMovies(list, (movies) => {\n          dispatch(addMovies(movies))\n        })\n      })\n    }\n  }\n}\n\nexport function addMovies(res) {\n  return {\n    type: 'ADD_MOVIES',\n    movies: res\n  }\n}\n\nexport function setMovies(movies) {\n  return {\n    type: 'SET_MOVIES',\n    movies: movies,\n  }\n}\n\nexport function setOptions(word, genre, sort, api) {\n  return {\n    type: 'SET_OPTIONS',\n    word: word,\n    genre: genre,\n    sort: sort,\n    api: api,\n  }\n}\n\nexport function fetching() {\n  return {\n    type: 'SEARCH_FETCHING'\n  }\n}\n"]},"metadata":{},"sourceType":"module"}