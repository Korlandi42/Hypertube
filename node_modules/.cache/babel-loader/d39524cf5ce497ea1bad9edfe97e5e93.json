{"ast":null,"code":"import _defineProperty from \"/Users/korlandi/42/hypertube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/Users/korlandi/42/hypertube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/korlandi/42/hypertube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/korlandi/42/hypertube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/korlandi/42/hypertube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/korlandi/42/hypertube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/korlandi/42/hypertube/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/korlandi/42/hypertube/src/components/account/Informations.jsx\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport { TextField, Button, Grid, Typography } from '@material-ui/core';\nimport { withStyles } from '@material-ui/core/styles';\nimport { req, validator, checkForm } from '../../utils';\nimport { alert } from '../../redux/snackbars/actions';\nimport host from '../../config';\n\nvar Informations =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Informations, _React$Component);\n\n  function Informations() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Informations);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Informations)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      form: {\n        username: '',\n        firstname: '',\n        lastname: '',\n        email: ''\n      },\n      formErrors: {\n        username: [],\n        firstname: [],\n        lastname: [],\n        email: []\n      }\n    };\n\n    _this.handleSubmit = function (e) {\n      e.preventDefault();\n      var _this$props = _this.props,\n          dispatch = _this$props.dispatch,\n          auth = _this$props.auth;\n\n      var body = _objectSpread({}, _this.state.form);\n\n      checkForm(body, _this.validate, function (errors, nbErrors) {\n        _this.setState(_objectSpread({}, _this.state, {\n          formErros: errors\n        }));\n\n        if (!nbErrors) {\n          req(host + '/api/users/' + auth.user.id, {\n            method: 'put',\n            body: body,\n            useToken: true\n          }).then(function (res) {\n            dispatch(alert('USER_EDIT_SUCCESS', 'success'));\n          });\n\n          if (_this.state.file) {\n            var data = new FormData();\n            data.append('file', _this.state.file);\n            req(host + '/api/media_objects/avatar/create', {\n              method: 'post',\n              body: data,\n              useToken: true,\n              contentType: false\n            });\n          }\n        }\n      });\n    };\n\n    _this.validate = function (name) {\n      validator.value = _this.state.form[name];\n      if (name === 'username') return validator.notNull().minLen(3).maxLen(20).errors;else if (name === 'firstname') return validator.notNull().isAlphabetic().maxLen(40).errors;else if (name === 'lastname') return validator.notNull().isAlphabetic().maxLen(40).errors;else if (name === 'email') return validator.isEmail().errors;\n    };\n\n    _this.onChange = function (e) {\n      var name = e.target.name;\n\n      _this.setState(_objectSpread({}, _this.state, {\n        form: _objectSpread({}, _this.state.form, _defineProperty({}, name, e.target.value))\n      }), function () {\n        _this.setState({\n          formErrors: _objectSpread({}, _this.state.formErrors, _defineProperty({}, name, _this.validate(name)))\n        });\n      });\n    };\n\n    _this.onFileChange = function (e) {\n      var file = e.target.files[0];\n      var reader = new FileReader();\n      reader.readAsDataURL(file);\n\n      reader.onload = function () {\n        _this.setState(_objectSpread({}, _this.state, {\n          image: reader.result\n        }), function () {\n          _this.setState(_objectSpread({}, _this.state, {\n            file: file\n          }));\n        });\n      };\n    };\n\n    return _this;\n  }\n\n  _createClass(Informations, [{\n    key: \"fetchUser\",\n    value: function fetchUser(id) {\n      var _this2 = this;\n\n      var dispatch = this.props.dispatch;\n      req(host + '/api/users/me', {\n        useToken: true\n      }).then(function (res) {\n        _this2.setState(_objectSpread({}, _this2.state, {\n          form: {\n            username: res.username,\n            firstname: res.firstname,\n            lastname: res.lastname,\n            email: res.email\n          }\n        }));\n      }).catch(function (err) {\n        if (err.status === 404) dispatch(alert('USER_NOT_FOUND', 'error'));\n      });\n    }\n  }, {\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.fetchUser();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var classes = this.props.classes;\n      var locale = this.props.locales.locale;\n      var formErrors = this.state.formErrors;\n      var _this$state$form = this.state.form,\n          lastname = _this$state$form.lastname,\n          firstname = _this$state$form.firstname,\n          username = _this$state$form.username,\n          email = _this$state$form.email;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, React.createElement(Typography, {\n        color: \"primary\",\n        variant: \"h5\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, locale.navbar.my_account), React.createElement(\"form\", {\n        onSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        container: true,\n        spacing: 16,\n        justify: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        error: formErrors.username.length ? true : false,\n        helperText: locale.validator[formErrors.username[0]],\n        name: \"username\",\n        label: locale.global.username,\n        onChange: this.onChange,\n        margin: \"normal\",\n        value: username,\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      })), React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        md: 6,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        error: formErrors.firstname.length ? true : false,\n        helperText: locale.validator[formErrors.firstname[0]],\n        name: \"firstname\",\n        label: locale.global.firstname,\n        onChange: this.onChange,\n        margin: \"normal\",\n        value: firstname,\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      })), React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        md: 6,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        error: formErrors.lastname.length ? true : false,\n        helperText: locale.validator[formErrors.lastname[0]],\n        name: \"lastname\",\n        label: locale.global.lastname,\n        onChange: this.onChange,\n        margin: \"normal\",\n        value: lastname,\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      })), React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        error: formErrors.email.length ? true : false,\n        helperText: locale.validator[formErrors.email[0]],\n        name: \"email\",\n        label: locale.global.email,\n        onChange: this.onChange,\n        margin: \"normal\",\n        value: email,\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      })), this.state.image && React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        sm: 6,\n        md: 7,\n        lg: 6,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: classes.avatar,\n        style: {\n          backgroundImage: 'url(' + this.state.image + ')'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      })), React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        accept: \"image/*\",\n        id: \"contained-button-file\",\n        type: \"file\",\n        style: {\n          display: 'none'\n        },\n        onChange: this.onFileChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        htmlFor: \"contained-button-file\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, React.createElement(Button, {\n        color: \"primary\",\n        component: \"span\",\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }, locale.register.upload)))), React.createElement(Button, {\n        type: \"submit\",\n        variant: \"outlined\",\n        color: \"primary\",\n        className: classes.button,\n        fullWidth: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, locale.account.btn)));\n    }\n  }]);\n\n  return Informations;\n}(React.Component);\n\nvar styles = {\n  button: {\n    marginTop: '10px'\n  },\n  avatar: {\n    width: '100%',\n    paddingBottom: '100%',\n    backgroundColor: '#222',\n    backgroundPosition: 'center',\n    backgroundRepeat: 'no-repeat',\n    backgroundSize: '100% auto',\n    borderRadius: '5px'\n  }\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return state;\n};\n\nvar InformationsExport = Informations;\nInformationsExport = withStyles(styles)(InformationsExport);\nInformationsExport = connect(mapStateToProps)(InformationsExport);\nexport default InformationsExport;","map":{"version":3,"sources":["/Users/korlandi/42/hypertube/src/components/account/Informations.jsx"],"names":["React","connect","TextField","Button","Grid","Typography","withStyles","req","validator","checkForm","alert","host","Informations","state","form","username","firstname","lastname","email","formErrors","handleSubmit","e","preventDefault","props","dispatch","auth","body","validate","errors","nbErrors","setState","formErros","user","id","method","useToken","then","res","file","data","FormData","append","contentType","name","value","notNull","minLen","maxLen","isAlphabetic","isEmail","onChange","target","onFileChange","files","reader","FileReader","readAsDataURL","onload","image","result","catch","err","status","fetchUser","classes","locale","locales","navbar","my_account","length","global","avatar","backgroundImage","display","register","upload","button","account","btn","Component","styles","marginTop","width","paddingBottom","backgroundColor","backgroundPosition","backgroundRepeat","backgroundSize","borderRadius","mapStateToProps","InformationsExport"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { connect } from 'react-redux'\nimport { TextField, Button, Grid, Typography } from '@material-ui/core'\nimport { withStyles } from '@material-ui/core/styles'\nimport { req, validator, checkForm } from '../../utils'\nimport { alert } from '../../redux/snackbars/actions'\nimport host from '../../config'\n\nclass Informations extends React.Component {\n\n  state = {\n    form: {\n      username: '',\n      firstname: '',\n      lastname: '',\n      email: '',\n    },\n    formErrors: {\n      username: [], firstname: [], lastname: [], email: []\n    }\n  }\n\n  fetchUser(id) {\n    const { dispatch } = this.props\n    req(host + '/api/users/me', {useToken: true})\n    .then(res => {\n      this.setState({\n        ...this.state,\n        form : {\n          username: res.username,\n          firstname: res.firstname,\n          lastname: res.lastname,\n          email: res.email,\n        }\n      })\n    }).catch(err => {\n      if (err.status === 404)\n        dispatch(alert('USER_NOT_FOUND', 'error'))\n    })\n  }\n\n  handleSubmit = (e) => {\n    e.preventDefault()\n    const { dispatch, auth } = this.props\n    const body = {...this.state.form}\n\n    checkForm(body, this.validate, (errors, nbErrors) => {\n      this.setState({...this.state, formErros: errors})\n      if (!nbErrors) {\n        req(host + '/api/users/' + auth.user.id, {\n          method: 'put',\n          body: body,\n          useToken: true,\n        })\n        .then(res => {\n          dispatch(alert('USER_EDIT_SUCCESS', 'success'))\n        })\n        if (this.state.file) {\n          const data = new FormData();\n          data.append('file', this.state.file)\n          req(host + '/api/media_objects/avatar/create', {\n            method: 'post',\n            body: data,\n            useToken: true,\n            contentType: false\n          })\n        }\n      }\n    })\n  }\n\n  validate = (name) => {\n    validator.value = this.state.form[name]\n\n    if (name === 'username')\n      return validator.notNull().minLen(3).maxLen(20).errors\n    else if (name === 'firstname')\n      return validator.notNull().isAlphabetic().maxLen(40).errors\n    else if (name === 'lastname')\n      return validator.notNull().isAlphabetic().maxLen(40).errors\n    else if (name === 'email')\n      return validator.isEmail().errors\n  }\n\n  onChange = (e) => {\n    let name = e.target.name\n    this.setState({\n      ...this.state,\n      form: {\n        ...this.state.form,\n        [name]: e.target.value\n      }\n    }, () => {\n      this.setState({\n        formErrors: {\n          ...this.state.formErrors,\n          [name]: this.validate(name)\n        }\n      })\n    })\n  }\n\n  onFileChange = (e) => {\n    const file = e.target.files[0]\n    let reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = () => {\n      this.setState({...this.state, image: reader.result}, () => {\n        this.setState({...this.state, file})\n      })\n    }\n  }\n\n  componentWillMount() {\n    this.fetchUser()\n  }\n\n  render () {\n    const { classes } = this.props\n    const { locale } = this.props.locales\n    const { formErrors } = this.state\n    const { lastname, firstname, username, email } = this.state.form\n\n    return (\n      <div>\n        <Typography color=\"primary\" variant=\"h5\">{locale.navbar.my_account }</Typography>\n        <form onSubmit={this.handleSubmit}>\n          <Grid container spacing={16} justify=\"center\">\n            <Grid item xs={12}>\n              <TextField\n                error={formErrors.username.length ? true : false}\n                helperText={locale.validator[formErrors.username[0]]}\n                name=\"username\"\n                label={locale.global.username}\n                onChange={this.onChange}\n                margin=\"normal\"\n                value={username}\n                fullWidth\n              />\n            </Grid>\n            <Grid item xs={12} md={6}>\n              <TextField\n                error={formErrors.firstname.length ? true : false}\n                helperText={locale.validator[formErrors.firstname[0]]}\n                name=\"firstname\"\n                label={locale.global.firstname}\n                onChange={this.onChange}\n                margin=\"normal\"\n                value={firstname}\n                fullWidth\n              />\n            </Grid>\n            <Grid item xs={12} md={6}>\n              <TextField\n                error={formErrors.lastname.length ? true : false}\n                helperText={locale.validator[formErrors.lastname[0]]}\n                name=\"lastname\"\n                label={locale.global.lastname}\n                onChange={this.onChange}\n                margin=\"normal\"\n                value={lastname}\n                fullWidth\n              />\n            </Grid>\n            <Grid item xs={12}>\n              <TextField\n                error={formErrors.email.length ? true : false}\n                helperText={locale.validator[formErrors.email[0]]}\n                name=\"email\"\n                label={locale.global.email}\n                onChange={this.onChange}\n                margin=\"normal\"\n                value={email}\n                fullWidth\n              />\n            </Grid>\n            {this.state.image &&\n              <Grid item xs={12} sm={6} md={7} lg={6}>\n                <div\n                  className={classes.avatar}\n                  style={{backgroundImage:'url(' + this.state.image + ')'}}\n                >\n                </div>\n              </Grid>\n            }\n            <Grid item xs={12}>\n              <input accept=\"image/*\" id=\"contained-button-file\" type=\"file\" style={{display: 'none'}} onChange={this.onFileChange}/>\n              <label htmlFor=\"contained-button-file\">\n                <Button color=\"primary\" component=\"span\" fullWidth>\n                  {locale.register.upload}\n                </Button>\n              </label>\n            </Grid>\n          </Grid>\n          <Button\n            type=\"submit\"\n            variant=\"outlined\"\n            color=\"primary\"\n            className={classes.button}\n            fullWidth\n          >\n            {locale.account.btn}\n          </Button>\n        </form>\n      </div>\n    )\n  }\n}\n\nconst styles = {\n  button: {\n    marginTop: '10px'\n  },\n  avatar: {\n    width: '100%',\n    paddingBottom: '100%',\n    backgroundColor: '#222',\n    backgroundPosition: 'center',\n    backgroundRepeat: 'no-repeat',\n    backgroundSize: '100% auto',\n    borderRadius: '5px'\n  }\n}\nconst mapStateToProps = (state) => {\n  return state\n}\n\nlet InformationsExport = Informations\nInformationsExport = withStyles(styles)(InformationsExport)\nInformationsExport = connect(mapStateToProps)(InformationsExport)\nexport default InformationsExport\n"]},"metadata":{},"sourceType":"module"}